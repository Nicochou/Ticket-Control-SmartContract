{"ast":null,"code":"import _classCallCheck from \"D:\\\\Projet\\\\ecole_etna\\\\final-project-feamcor\\\\bileto\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\Projet\\\\ecole_etna\\\\final-project-feamcor\\\\bileto\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"D:\\\\Projet\\\\ecole_etna\\\\final-project-feamcor\\\\bileto\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"D:\\\\Projet\\\\ecole_etna\\\\final-project-feamcor\\\\bileto\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"D:\\\\Projet\\\\ecole_etna\\\\final-project-feamcor\\\\bileto\\\\client\\\\src\\\\AccountInfo.jsx\";\nimport React, { Component } from \"react\";\n\nvar AccountInfo = /*#__PURE__*/function (_Component) {\n  _inherits(AccountInfo, _Component);\n\n  var _super = _createSuper(AccountInfo);\n\n  function AccountInfo() {\n    var _this;\n\n    _classCallCheck(this, AccountInfo);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      dataKey1: null,\n      dataKey2: null,\n      dataKey3: null\n    };\n    return _this;\n  }\n\n  _createClass(AccountInfo, [{\n    key: \"formatWeiToEther\",\n    value: function formatWeiToEther(_amount) {\n      var _output = !_amount ? \"???\" : this.props.drizzle.web3.utils.fromWei(_amount.toString(), \"ether\");\n\n      _output += \" ETHER\";\n      return _output;\n    }\n  }, {\n    key: \"fetchData\",\n    value: function fetchData() {\n      var Bileto = this.props.drizzle.contracts.Bileto;\n      var accounts = this.props.drizzleState.accounts;\n      var dataKey1 = Bileto.methods.getAccountRole.cacheCall(accounts[0]);\n      var dataKey2 = Bileto.methods.getCountOrganizerEvents.cacheCall(accounts[0]);\n      var dataKey3 = Bileto.methods.getCountCustomerPurchases.cacheCall(accounts[0]);\n      this.setState({\n        dataKey1,\n        dataKey2,\n        dataKey3\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchData();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.drizzleState.accounts[0] !== prevProps.drizzleState.accounts[0]) {\n        this.fetchData();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props$drizzleSt = this.props.drizzleState,\n          drizzleStatus = _this$props$drizzleSt.drizzleStatus,\n          web3 = _this$props$drizzleSt.web3;\n\n      if (!drizzleStatus.initialized || web3.status !== \"initialized\") {\n        return \"Loading...\";\n      }\n\n      var _this$props$drizzleSt2 = this.props.drizzleState,\n          accounts = _this$props$drizzleSt2.accounts,\n          accountBalances = _this$props$drizzleSt2.accountBalances;\n      var Bileto = this.props.drizzleState.contracts.Bileto;\n      var accountRole = Bileto.getAccountRole[this.state.dataKey1];\n\n      if (!accountRole || !accountRole.value) {\n        return \"Loading...\";\n      }\n\n      var countOrganizerEvents = Bileto.getCountOrganizerEvents[this.state.dataKey2];\n\n      if (!countOrganizerEvents || !countOrganizerEvents.value) {\n        return \"Loading...\";\n      }\n\n      var countCustomerPurchases = Bileto.getCountCustomerPurchases[this.state.dataKey3];\n\n      if (!countCustomerPurchases || !countCustomerPurchases.value) {\n        return \"Loading...\";\n      }\n\n      var _accountRole$value = accountRole.value,\n          accountIsOwner = _accountRole$value.accountIsOwner,\n          accountIsOrganizer = _accountRole$value.accountIsOrganizer,\n          accountIsCustomer = _accountRole$value.accountIsCustomer;\n      var countEvents = countOrganizerEvents.value;\n      var countPurchases = countCustomerPurchases.value;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card shadow text-white bg-primary h-100\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"card-header\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }\n      }, \"ACCOUNT\"), \" information\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card-body\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"card-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }\n      }, \"Address: \"), accounts[0]), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"card-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }\n      }, \"Balance: \"), this.formatWeiToEther(accountBalances[accounts[0]])), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"card-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }\n      }, \"Roles: \"), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"card-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }\n      }, accountIsOwner === true && \" OWNER \", accountIsOwner === true && accountIsOrganizer === true && \"/\", accountIsOrganizer === true && \" ORGANIZER (\" + countEvents + \" events)\", (accountIsOwner === true || accountIsOrganizer === true) && accountIsCustomer === true && \"/\", accountIsCustomer === true && \" CUSTOMER (\" + countPurchases + \" purchases)\", accountIsOwner === false && accountIsOrganizer === false && accountIsCustomer === false && \" NONE \"))));\n    }\n  }]);\n\n  return AccountInfo;\n}(Component);\n\nexport default AccountInfo;","map":{"version":3,"sources":["D:/Projet/ecole_etna/final-project-feamcor/bileto/client/src/AccountInfo.jsx"],"names":["React","Component","AccountInfo","state","dataKey1","dataKey2","dataKey3","_amount","_output","props","drizzle","web3","utils","fromWei","toString","Bileto","contracts","accounts","drizzleState","methods","getAccountRole","cacheCall","getCountOrganizerEvents","getCountCustomerPurchases","setState","fetchData","prevProps","drizzleStatus","initialized","status","accountBalances","accountRole","value","countOrganizerEvents","countCustomerPurchases","accountIsOwner","accountIsOrganizer","accountIsCustomer","countEvents","countPurchases","formatWeiToEther"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;IAEMC,W;;;;;;;;;;;;;;;UACJC,K,GAAQ;AAAEC,MAAAA,QAAQ,EAAE,IAAZ;AAAkBC,MAAAA,QAAQ,EAAE,IAA5B;AAAkCC,MAAAA,QAAQ,EAAE;AAA5C,K;;;;;;qCAESC,O,EAAS;AACxB,UAAIC,OAAO,GAAG,CAACD,OAAD,GACV,KADU,GAEV,KAAKE,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwBC,KAAxB,CAA8BC,OAA9B,CAAsCN,OAAO,CAACO,QAAR,EAAtC,EAA0D,OAA1D,CAFJ;;AAGAN,MAAAA,OAAO,IAAI,QAAX;AACA,aAAOA,OAAP;AACD;;;gCAEW;AAAA,UACFO,MADE,GACS,KAAKN,KAAL,CAAWC,OAAX,CAAmBM,SAD5B,CACFD,MADE;AAAA,UAEFE,QAFE,GAEW,KAAKR,KAAL,CAAWS,YAFtB,CAEFD,QAFE;AAGV,UAAMb,QAAQ,GAAGW,MAAM,CAACI,OAAP,CAAeC,cAAf,CAA8BC,SAA9B,CAAwCJ,QAAQ,CAAC,CAAD,CAAhD,CAAjB;AACA,UAAMZ,QAAQ,GAAGU,MAAM,CAACI,OAAP,CAAeG,uBAAf,CAAuCD,SAAvC,CACfJ,QAAQ,CAAC,CAAD,CADO,CAAjB;AAGA,UAAMX,QAAQ,GAAGS,MAAM,CAACI,OAAP,CAAeI,yBAAf,CAAyCF,SAAzC,CACfJ,QAAQ,CAAC,CAAD,CADO,CAAjB;AAGA,WAAKO,QAAL,CAAc;AAAEpB,QAAAA,QAAF;AAAYC,QAAAA,QAAZ;AAAsBC,QAAAA;AAAtB,OAAd;AACD;;;wCAEmB;AAClB,WAAKmB,SAAL;AACD;;;uCAEkBC,S,EAAW;AAC5B,UACE,KAAKjB,KAAL,CAAWS,YAAX,CAAwBD,QAAxB,CAAiC,CAAjC,MAAwCS,SAAS,CAACR,YAAV,CAAuBD,QAAvB,CAAgC,CAAhC,CAD1C,EAEE;AACA,aAAKQ,SAAL;AACD;AACF;;;6BAEQ;AAAA,kCACyB,KAAKhB,KAAL,CAAWS,YADpC;AAAA,UACCS,aADD,yBACCA,aADD;AAAA,UACgBhB,IADhB,yBACgBA,IADhB;;AAEP,UAAI,CAACgB,aAAa,CAACC,WAAf,IAA8BjB,IAAI,CAACkB,MAAL,KAAgB,aAAlD,EAAiE;AAC/D,eAAO,YAAP;AACD;;AAJM,mCAM+B,KAAKpB,KAAL,CAAWS,YAN1C;AAAA,UAMCD,QAND,0BAMCA,QAND;AAAA,UAMWa,eANX,0BAMWA,eANX;AAAA,UAOCf,MAPD,GAOY,KAAKN,KAAL,CAAWS,YAAX,CAAwBF,SAPpC,CAOCD,MAPD;AASP,UAAMgB,WAAW,GAAGhB,MAAM,CAACK,cAAP,CAAsB,KAAKjB,KAAL,CAAWC,QAAjC,CAApB;;AACA,UAAI,CAAC2B,WAAD,IAAgB,CAACA,WAAW,CAACC,KAAjC,EAAwC;AACtC,eAAO,YAAP;AACD;;AAED,UAAMC,oBAAoB,GACxBlB,MAAM,CAACO,uBAAP,CAA+B,KAAKnB,KAAL,CAAWE,QAA1C,CADF;;AAEA,UAAI,CAAC4B,oBAAD,IAAyB,CAACA,oBAAoB,CAACD,KAAnD,EAA0D;AACxD,eAAO,YAAP;AACD;;AAED,UAAME,sBAAsB,GAC1BnB,MAAM,CAACQ,yBAAP,CAAiC,KAAKpB,KAAL,CAAWG,QAA5C,CADF;;AAEA,UAAI,CAAC4B,sBAAD,IAA2B,CAACA,sBAAsB,CAACF,KAAvD,EAA8D;AAC5D,eAAO,YAAP;AACD;;AAxBM,+BA8BHD,WAAW,CAACC,KA9BT;AAAA,UA2BLG,cA3BK,sBA2BLA,cA3BK;AAAA,UA4BLC,kBA5BK,sBA4BLA,kBA5BK;AAAA,UA6BLC,iBA7BK,sBA6BLA,iBA7BK;AAgCP,UAAMC,WAAW,GAAGL,oBAAoB,CAACD,KAAzC;AAEA,UAAMO,cAAc,GAAGL,sBAAsB,CAACF,KAA9C;AAEA,0BACE;AAAK,QAAA,SAAS,EAAC,yCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAI,QAAA,SAAS,EAAC,aAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,iBADF,eAIE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAG,QAAA,SAAS,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAEGf,QAAQ,CAAC,CAAD,CAFX,CADF,eAKE;AAAG,QAAA,SAAS,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAEG,KAAKuB,gBAAL,CAAsBV,eAAe,CAACb,QAAQ,CAAC,CAAD,CAAT,CAArC,CAFH,CALF,eASE;AAAG,QAAA,SAAS,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,eAEE;AAAM,QAAA,SAAS,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGkB,cAAc,KAAK,IAAnB,IAA2B,SAD9B,EAEGA,cAAc,KAAK,IAAnB,IAA2BC,kBAAkB,KAAK,IAAlD,IAA0D,GAF7D,EAGGA,kBAAkB,KAAK,IAAvB,IACC,iBAAiBE,WAAjB,GAA+B,UAJnC,EAKG,CAACH,cAAc,KAAK,IAAnB,IAA2BC,kBAAkB,KAAK,IAAnD,KACCC,iBAAiB,KAAK,IADvB,IAEC,GAPJ,EAQGA,iBAAiB,KAAK,IAAtB,IACC,gBAAgBE,cAAhB,GAAiC,aATrC,EAUGJ,cAAc,KAAK,KAAnB,IACCC,kBAAkB,KAAK,KADxB,IAECC,iBAAiB,KAAK,KAFvB,IAGC,QAbJ,CAFF,CATF,CAJF,CADF;AAmCD;;;;EA3GuBpC,S;;AA8G1B,eAAeC,WAAf","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nclass AccountInfo extends Component {\r\n  state = { dataKey1: null, dataKey2: null, dataKey3: null };\r\n\r\n  formatWeiToEther(_amount) {\r\n    let _output = !_amount\r\n      ? \"???\"\r\n      : this.props.drizzle.web3.utils.fromWei(_amount.toString(), \"ether\");\r\n    _output += \" ETHER\";\r\n    return _output;\r\n  }\r\n\r\n  fetchData() {\r\n    const { Bileto } = this.props.drizzle.contracts;\r\n    const { accounts } = this.props.drizzleState;\r\n    const dataKey1 = Bileto.methods.getAccountRole.cacheCall(accounts[0]);\r\n    const dataKey2 = Bileto.methods.getCountOrganizerEvents.cacheCall(\r\n      accounts[0]\r\n    );\r\n    const dataKey3 = Bileto.methods.getCountCustomerPurchases.cacheCall(\r\n      accounts[0]\r\n    );\r\n    this.setState({ dataKey1, dataKey2, dataKey3 });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchData();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (\r\n      this.props.drizzleState.accounts[0] !== prevProps.drizzleState.accounts[0]\r\n    ) {\r\n      this.fetchData();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { drizzleStatus, web3 } = this.props.drizzleState;\r\n    if (!drizzleStatus.initialized || web3.status !== \"initialized\") {\r\n      return \"Loading...\";\r\n    }\r\n\r\n    const { accounts, accountBalances } = this.props.drizzleState;\r\n    const { Bileto } = this.props.drizzleState.contracts;\r\n\r\n    const accountRole = Bileto.getAccountRole[this.state.dataKey1];\r\n    if (!accountRole || !accountRole.value) {\r\n      return \"Loading...\";\r\n    }\r\n\r\n    const countOrganizerEvents =\r\n      Bileto.getCountOrganizerEvents[this.state.dataKey2];\r\n    if (!countOrganizerEvents || !countOrganizerEvents.value) {\r\n      return \"Loading...\";\r\n    }\r\n\r\n    const countCustomerPurchases =\r\n      Bileto.getCountCustomerPurchases[this.state.dataKey3];\r\n    if (!countCustomerPurchases || !countCustomerPurchases.value) {\r\n      return \"Loading...\";\r\n    }\r\n\r\n    const {\r\n      accountIsOwner,\r\n      accountIsOrganizer,\r\n      accountIsCustomer\r\n    } = accountRole.value;\r\n\r\n    const countEvents = countOrganizerEvents.value;\r\n\r\n    const countPurchases = countCustomerPurchases.value;\r\n\r\n    return (\r\n      <div className=\"card shadow text-white bg-primary h-100\">\r\n        <h5 className=\"card-header\">\r\n          <strong>ACCOUNT</strong> information\r\n        </h5>\r\n        <div className=\"card-body\">\r\n          <p className=\"card-text\">\r\n            <strong>Address: </strong>\r\n            {accounts[0]}\r\n          </p>\r\n          <p className=\"card-text\">\r\n            <strong>Balance: </strong>\r\n            {this.formatWeiToEther(accountBalances[accounts[0]])}\r\n          </p>\r\n          <p className=\"card-text\">\r\n            <strong>Roles: </strong>\r\n            <span className=\"card-text\">\r\n              {accountIsOwner === true && \" OWNER \"}\r\n              {accountIsOwner === true && accountIsOrganizer === true && \"/\"}\r\n              {accountIsOrganizer === true &&\r\n                \" ORGANIZER (\" + countEvents + \" events)\"}\r\n              {(accountIsOwner === true || accountIsOrganizer === true) &&\r\n                accountIsCustomer === true &&\r\n                \"/\"}\r\n              {accountIsCustomer === true &&\r\n                \" CUSTOMER (\" + countPurchases + \" purchases)\"}\r\n              {accountIsOwner === false &&\r\n                accountIsOrganizer === false &&\r\n                accountIsCustomer === false &&\r\n                \" NONE \"}\r\n            </span>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AccountInfo;\r\n"]},"metadata":{},"sourceType":"module"}